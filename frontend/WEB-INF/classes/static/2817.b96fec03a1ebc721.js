"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[2817],{32817:function(q,f,o){o.r(f),o.d(f,{SubstanceFormConstituentsModule:function(){return L}});var l=o(48047),d=o(78069),u=o(36362),Z=o(64061),b=o(44770),y=o(43365),v=o(90587),T=o(7168),O=o(80206),x=o(98568),C=o(20265),M=o(24582),P=(o(27299),o(40104)),S=o(79550),A=o(26984),t=o(76442),F=o(78444),U=o(51279),I=o(18291),D=o(63169),J=o(27164),N=o(95758),Q=o(54244);function Y(i,s){if(1&i){var e=t.EpF();t.TgZ(0,"div",20),t._uU(1," Deleted\xa0 "),t.TgZ(2,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().undoDelete()}),t._UZ(3,"mat-icon",22),t.qZA(),t.qZA()}}function w(i,s){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){var e=t.oxw();t.xp6(1),t.hij(" ",e.displayAmount(e.privateConstituent.amount)," ")}}function k(i,s){if(1&i&&(t.TgZ(0,"div",2),t.TgZ(1,"div",23),t._UZ(2,"app-domain-references",24,25),t.qZA(),t.qZA()),2&i){var e=t.oxw();t.xp6(2),t.Q6J("referencesUuids",e.privateConstituent.references)}}var g=function(){var i=function(){function s(e,n,a,c){(0,d.Z)(this,s),this.cvService=e,this.dialog=n,this.utilsService=a,this.overlayContainerService=c,this.constituentDeleted=new t.vpe,this.subscriptions=[]}return(0,l.Z)(s,[{key:"ngOnInit",value:function(){this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"constituent",get:function(){return this.privateConstituent},set:function(n){this.privateConstituent=n,this.constituent.substance&&(this.relatedSubstanceUuid=this.privateConstituent.substance.refuuid)}},{key:"delete",value:function(){var n=this;this.privateConstituent.$$deletedCode=this.utilsService.newUUID(),this.privateConstituent.substance||(this.deleteTimer=setTimeout(function(){n.constituentDeleted.emit(n.privateConstituent)},2e3))}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.privateConstituent.$$deletedCode}},{key:"openAmountDialog",value:function(){var n=this;this.privateConstituent.amount||(this.privateConstituent.amount={});var a=this.dialog.open(J.O,{data:{subsAmount:this.privateConstituent.amount},width:"990px"});this.overlayContainer.style.zIndex="1002";var c=a.afterClosed().subscribe(function(r){n.overlayContainer.style.zIndex=null,r&&(n.privateConstituent.amount=r)});this.subscriptions.push(c)}},{key:"updateProcess",value:function(n){this.privateConstituent.role=n}},{key:"updateAccess",value:function(n){this.privateConstituent.access=n}},{key:"relatedSubstanceUpdated",value:function(n){this.privateConstituent.substance={refPname:n._name,name:n._name,refuuid:n.uuid,substanceClass:"reference",approvalID:n.approvalID},this.relatedSubstanceUuid=this.privateConstituent.substance.refuuid}},{key:"displayAmount",value:function(n){return this.utilsService.displayAmount(n)}},{key:"formatValue",value:function(n){return n?"object"==typeof n?n.display?n.display:n.value?n.value:null:n:null}}]),s}();return i.\u0275fac=function(e){return new(e||i)(t.Y36(I.I),t.Y36(N.uw),t.Y36(D.FW),t.Y36(Q.Xj))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-constituent-form"]],inputs:{constituent:"constituent"},outputs:{constituentDeleted:"constituentDeleted"},decls:21,vars:6,consts:[[1,"constituent-form-container"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete code",3,"click"],["svgIcon","delete_forever"],[1,"flex-column","related-substance"],["eventCategory","substanceRelationshipRelatedSub","placeholder","Related Substance","header","Related Substance",3,"subuuid","selectionUpdated"],[1,"field-column"],[1,"role"],["domain","CONSTITUENT_ROLE","title","constituent role",3,"model","valueChange"],[1,"amount"],[1,"label","amt-label"],["mat-icon-button","","matTooltip","add",3,"click"],["svgIcon","add_circle_outline"],[1,"amount-display"],[4,"ngIf"],[1,"access"],[3,"access","accessOut"],["class","form-row",4,"ngIf"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"references-container"],[3,"referencesUuids"],["references",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Y,4,0,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"button",4),t.NdJ("click",function(){return n.delete()}),t._UZ(5,"mat-icon",5),t.qZA(),t.qZA(),t.TgZ(6,"div",6),t.TgZ(7,"app-substance-selector",7),t.NdJ("selectionUpdated",function(c){return n.relatedSubstanceUpdated(c)}),t.qZA(),t.qZA(),t.TgZ(8,"div",8),t.TgZ(9,"div",9),t.TgZ(10,"app-cv-input",10),t.NdJ("valueChange",function(c){return n.updateProcess(c)}),t.qZA(),t.qZA(),t.TgZ(11,"div",11),t.TgZ(12,"div",12),t._uU(13," Amount "),t.TgZ(14,"button",13),t.NdJ("click",function(){return n.openAmountDialog()}),t._UZ(15,"mat-icon",14),t.qZA(),t.qZA(),t.TgZ(16,"div",15),t.YNc(17,w,2,1,"div",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",17),t.TgZ(19,"app-access-manager",18),t.NdJ("accessOut",function(c){return n.updateAccess(c)}),t.qZA(),t.qZA(),t.qZA(),t.YNc(20,k,4,1,"div",19),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.constituent.$$deletedCode),t.xp6(6),t.Q6J("subuuid",n.relatedSubstanceUuid),t.xp6(3),t.Q6J("model",n.privateConstituent.role),t.xp6(7),t.Q6J("ngIf",n.privateConstituent.amount),t.xp6(2),t.Q6J("access",n.constituent.access),t.xp6(1),t.Q6J("ngIf",!n.privateConstituent.$$deletedCode))},styles:[".constituent-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.related-substance[_ngcontent-%COMP%]{max-width:60%;width:60%;padding-right:20px}  .related-substance img{max-width:125px!important;margin:auto}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row[_ngcontent-%COMP%]{-ms-flex-align:start;align-items:flex-start;-ms-flex-line-pack:start;align-content:flex-start;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .field-column[_ngcontent-%COMP%]{width:70%}.form-row[_ngcontent-%COMP%]   .field-column[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{width:100%;margin-top:37px}.form-row[_ngcontent-%COMP%]   .field-column[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.form-row[_ngcontent-%COMP%]   .code-system[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .code-system-type[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-row[_ngcontent-%COMP%]   .code-text[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.form-row[_ngcontent-%COMP%]   .access[_ngcontent-%COMP%]{width:15%}.references-container[_ngcontent-%COMP%]{width:100%}.padded[_ngcontent-%COMP%]{padding-right:20px}.amount-display[_ngcontent-%COMP%]{padding-top:11px}.form-actions[_ngcontent-%COMP%]{-ms-flex-pack:start;justify-content:flex-start;margin:5px 0 10px}.form-content[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.mod-type[_ngcontent-%COMP%], .location-type[_ngcontent-%COMP%], .sites[_ngcontent-%COMP%], .group-access[_ngcontent-%COMP%], .extent[_ngcontent-%COMP%], .amount[_ngcontent-%COMP%]{width:33%}.group[_ngcontent-%COMP%], .access[_ngcontent-%COMP%]{width:45%}"]}),i}(),h=o(19975),m=o(87317),p=o(65590);function $(i,s){1&i&&t._UZ(0,"mat-divider",8),2&i&&t.Q6J("inset",!0)}function j(i,s){if(1&i){var e=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"app-constituent-form",6),t.NdJ("constituentDeleted",function(G){return t.CHM(e),t.oxw().deleteConstituent(G)}),t.qZA(),t.YNc(2,$,1,1,"mat-divider",7),t.qZA()}if(2&i){var n=s.$implicit,a=s.last;t.Q6J("id","substance-constituent-"+s.index),t.xp6(1),t.Q6J("constituent",n),t.xp6(1),t.Q6J("ngIf",!a)}}var E=function(){var i=function(s){function e(n,a,c){var r;return(0,d.Z)(this,e),r=function R(i,s,e){return s=(0,C.Z)(s),(0,O.Z)(i,(0,x.Z)()?Reflect.construct(s,e||[],(0,C.Z)(i).constructor):s.apply(i,e))}(this,e,[c]),r.substanceFormConstituentsService=n,r.scrollToService=a,r.gaService=c,r.subscriptions=[],r.analyticsEventCategory="substance form constituents",r}return(0,M.Z)(e,s),(0,l.Z)(e,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("Constituents")}},{key:"ngAfterViewInit",value:function(){var a=this,c=this.substanceFormConstituentsService.substanceConstituents.subscribe(function(r){a.constituents=r});this.subscriptions.push(c)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(a){a.unsubscribe()})}},{key:"addItem",value:function(){this.addConstituent()}},{key:"addConstituent",value:function(){var a=this;this.substanceFormConstituentsService.addSubstanceConstituent(),setTimeout(function(){a.scrollToService.scrollToElement("substance-constituent-0","center")})}},{key:"deleteConstituent",value:function(a){this.substanceFormConstituentsService.deleteSubstanceConstituent(a)}}]),e}(S.u);return i.\u0275fac=function(e){return new(e||i)(t.Y36(A.D),t.Y36(F.i),t.Y36(P.$))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-substance-form-constituents-card"]],features:[t.qOj],decls:8,vars:1,consts:[[1,"flex-row"],[1,"middle-fill"],["class","alternate-backgrounds","appScrollToTarget","",3,"id",4,"ngFor","ngForOf"],["mat-button","",3,"click"],["svgIcon","add_circle_outline"],["appScrollToTarget","",1,"alternate-backgrounds",3,"id"],[3,"constituent","constituentDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[1,"form-divider",3,"inset"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"span",1),t.qZA(),t.YNc(2,j,3,3,"div",2),t.TgZ(3,"div",0),t._UZ(4,"span",1),t.TgZ(5,"button",3),t.NdJ("click",function(){return n.addConstituent()}),t._uU(6," Add Constituent "),t._UZ(7,"mat-icon",4),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.constituents))},directives:[u.sg,U.P,g,u.O5,h.d,m.lW,p.Hw],styles:[""]}),i}(),z=o(94673),V=o(26439),_=o(63200),H=o(24459),X=o(16667),W=o(84577),B=o(48302),L=function(){var i=(0,l.Z)(function s(){(0,d.Z)(this,s)});return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.ez,Z.o.forChild(E),T.O,h.t,p.Ps,m.ot,z.w,b.lN,v.UX,v.u5,V.TU,y.c,_.U]]}),i}();t.B6R(g,[u.O5,m.lW,p.Hw,H.Q,X.S,W.h,B.V],[])}}]);
//# sourceMappingURL=2817.b96fec03a1ebc721.js.map