"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[3298],{23298:function(ve,R,i){i.r(R),i.d(R,{SubstanceFormSimplifiedReferencesModule:function(){return pe}});var g=i(48047),h=i(78069),m=i(36362),N=i(95106),E=i(32090),Y=i(10853),U=i(98568),T=i(20265),Q=i(24582),z=i(79550),j=i(40104),H=i(26562),L=i(80155),x=i(24936),W=i(32685),$=i(59295),F=i(33567),V=i(39756),w=i(66452),B=i(27336),e=i(76442),O=i(95758),X=i(78444),Z=i(54244),C=i(44770),S=i(43365),d=i(90587),A=i(26439),k=i(51279),K=i(63169),M=i(87317),P=i(40089),I=i(65590),G=i(16667),q=i(84577);function _(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"div",8),e._uU(1," Deleted\xa0 "),e.TgZ(2,"button",9),e.NdJ("click",function(){return e.CHM(r),e.oxw().undoDelete()}),e._UZ(3,"mat-icon",10),e.qZA(),e.qZA()}}function ee(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"button",12),e.NdJ("click",function(){return e.CHM(r),e.oxw().deleteReference()}),e._UZ(2,"mat-icon",13),e.qZA(),e.qZA()}}var ne=function(){var o=function(){return(0,g.Z)(function a(r,n,t,s,c){(0,h.Z)(this,a),this.utilsService=r,this.substanceFormReferencesService=n,this.dialog=t,this.overlayContainerService=s,this.substanceFormService=c,this.referenceDeleted=new e.vpe,this.hideDelete=!1,this.showPrev=!1,this.loading=!1,this.error=!1,this.subscriptions=[]},[{key:"ngOnInit",value:function(){this.overlayContainer=this.overlayContainerService.getContainerElement(),this.reference.publicDomain=!1,this.reference.access=["protected"]}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(n){n.unsubscribe()})}},{key:"updateAccess",value:function(n){this.reference.access=n}},{key:"setSourceType",value:function(n){n&&(this.reference.docType=n)}},{key:"updateTags",value:function(n){this.reference.tags=n}},{key:"isValid",get:function(){return!(!this.reference.docType||!this.reference.citation)}},{key:"deleteReference",value:function(){var n=this;this.reference.$$deletedCode=this.utilsService.newUUID(),this.reference.docType||this.reference.citation||this.reference.uploadedFile?this.substanceFormReferencesService.emitReferencesUpdate():this.deleteTimer=setTimeout(function(){n.referenceDeleted.emit(n.reference)},2e3)}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.reference.$$deletedCode,this.substanceFormReferencesService.emitReferencesUpdate()}},{key:"fileSelected",value:function(n){var t=this;this.error=!1,null!=n&&(this.loading=!0,this.utilsService.uploadFile(n).subscribe(function(s){t.reference.uploadedFile=s,t.loading=!1},function(s){t.loading=!1,t.error=!0}))}}])}();return o.\u0275fac=function(r){return new(r||o)(e.Y36(K.FW),e.Y36(x.v),e.Y36(O.uw),e.Y36(Z.Xj),e.Y36(F.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-reference-form"]],inputs:{reference:"reference",hideDelete:"hideDelete"},outputs:{referenceDeleted:"referenceDeleted"},decls:9,vars:5,consts:[[1,"reference-form-container"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],["class","delete-container",4,"ngIf"],["required","true","domain","DOCUMENT_TYPE","title","Source Type",1,"source-type",3,"model","valueChange"],[1,"citation"],["matInput","","placeholder","Source Text/Citation","required","","name","citation",3,"ngModel","ngModelChange"],[3,"access","accessOut"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete reference",3,"click"],["svgIcon","delete_forever"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0),e.YNc(1,_,4,0,"div",1),e.TgZ(2,"div",2),e.YNc(3,ee,3,0,"div",3),e.TgZ(4,"app-cv-input",4),e.NdJ("valueChange",function(s){return n.setSourceType(s)}),e.qZA(),e.TgZ(5,"mat-form-field",5),e.TgZ(6,"input",6),e.NdJ("ngModelChange",function(s){return n.reference.citation=s}),e.qZA(),e.qZA(),e.TgZ(7,"div"),e.TgZ(8,"app-access-manager",7),e.NdJ("accessOut",function(s){return n.updateAccess(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(1),e.Q6J("ngIf",n.reference.$$deletedCode),e.xp6(2),e.Q6J("ngIf",n.reference.uuid),e.xp6(1),e.Q6J("model",n.reference.docType),e.xp6(2),e.Q6J("ngModel",n.reference.citation),e.xp6(2),e.Q6J("access",n.reference.access))},directives:[m.O5,M.lW,P.gM,I.Hw,G.S,C.KE,S.Nt,d.Fj,d.Q7,d.JJ,d.On,q.h],styles:[".reference-form-container[_ngcontent-%COMP%]{padding:10px 3px 4px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0 10px;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .source-type[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .citation[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-actions[_ngcontent-%COMP%]{-ms-flex-pack:start;justify-content:flex-start;margin:5px 0 10px}.url[_ngcontent-%COMP%]{width:30%}.tags[_ngcontent-%COMP%]{width:40%}.previous-ref[_ngcontent-%COMP%]{margin:auto;width:90%}.spinner[_ngcontent-%COMP%]{height:20px;width:20px}.loading-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;text-align:center;height:26px}.spinner-container[_ngcontent-%COMP%]{height:20px;width:20px;margin-right:5px}.progress-spinner[_ngcontent-%COMP%]{margin:auto}.mat-progress-spinner[_ngcontent-%COMP%]{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]     svg{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:20px!important;width:20px!important}"]}),o}(),D=i(19975);function re(o,a){if(1&o&&(e.TgZ(0,"mat-form-field",5),e._UZ(1,"input",6),e.qZA()),2&o){var r=e.oxw();e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",r.searchControl)}}var J=function(){return[5,10,25,100]};function ie(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"mat-paginator",7),e.NdJ("page",function(s){e.CHM(r);var c=e.oxw();return c.pageChange(s,c.analyticsEventCategory)}),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,J))}}function oe(o,a){1&o&&e._UZ(0,"mat-divider",11),2&o&&e.Q6J("inset",!0)}function se(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"app-reference-form",9),e.NdJ("referenceDeleted",function(c){return e.CHM(r),e.oxw().deleteReference(c)}),e.qZA(),e.YNc(2,oe,1,1,"mat-divider",10),e.qZA()}if(2&o){var n=a.$implicit,t=a.last;e.Q6J("id",n.uuid),e.xp6(1),e.Q6J("reference",n),e.xp6(1),e.Q6J("ngIf",!t)}}function ae(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"mat-paginator",7),e.NdJ("page",function(s){e.CHM(r);var c=e.oxw();return c.pageChange(s,c.analyticsEventCategory)}),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,J))}}var ce=function(){var o=function(a){function r(n,t,s,c,f,y,b,v,p){var l;return(0,h.Z)(this,r),l=function te(o,a,r){return a=(0,T.Z)(a),(0,Y.Z)(o,(0,U.Z)()?Reflect.construct(a,r||[],(0,T.Z)(o).constructor):a.apply(o,r))}(this,r,[v]),l.substanceFormService=n,l.substanceFormReferencesService=t,l.substanceFormNamesService=s,l.substanceFormCodesService=c,l.substanceFormStructureService=f,l.dialog=y,l.scrollToService=b,l.gaService=v,l.overlayContainerService=p,l.domainKeys=W.Q,l.subscriptions=[],l.analyticsEventCategory="substance form references",l}return(0,Q.Z)(r,a),(0,g.Z)(r,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("References"),this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var t=this,s=this.substanceFormReferencesService.substanceReferences.subscribe(function(p){t.references=p,t.filtered=p;var l=t.searchControl.valueChanges.subscribe(function(u){t.filterList(u,t.references,t.analyticsEventCategory)},function(u){console.log(u)});t.subscriptions.push(l),t.page=0,t.pageChange()}),c=this.substanceFormNamesService.substanceNames.subscribe(function(){return t.applyAllReferencesToAll()}),f=this.substanceFormCodesService.substanceCodes.subscribe(function(){return t.applyAllReferencesToAll()}),y=this.substanceFormStructureService.substanceStructure.subscribe(function(){return t.applyAllReferencesToAll()}),b=this.substanceFormReferencesService.domainsWithReferences.pipe((0,$.q)(1)).subscribe(function(p){t.domainsWithReferences=p});this.subscriptions.push(s),this.subscriptions.push(c),this.subscriptions.push(f),this.subscriptions.push(y),this.subscriptions.push(b);var v=(0,H.a)([this.substanceFormService.simplifiedForm,this.substanceFormReferencesService.substanceReferences.pipe((0,L.P)())]).subscribe({next:function(l){var u=(0,E.Z)(l,2);u[0]&&0==u[1].length&&t.addDefaultSubstanceReference()},error:function(l){console.error(l)}});this.subscriptions.push(v)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(t){t.unsubscribe()})}},{key:"addItem",value:function(){this.addSubstanceReference()}},{key:"addDefaultSubstanceReference",value:function(){var t=this.substanceFormReferencesService.addSubstanceReference({docType:"MANUFACTURER PRODUCT DESCRIPTION",citation:""});this.applyToAll(t.uuid)}},{key:"addSubstanceReference",value:function(){var t=this,s=this.substanceFormReferencesService.addSubstanceReference({});this.applyToAll(s.uuid),setTimeout(function(){t.scrollToService.scrollToElement(s.uuid,"center")},10)}},{key:"applyAllReferencesToAll",value:function(){var s,t=(0,N.Z)(this.references);try{for(t.s();!(s=t.n()).done;)this.applyToAll(s.value.uuid)}catch(f){t.e(f)}finally{t.f()}}},{key:"deleteReference",value:function(t){this.substanceFormReferencesService.deleteSubstanceReference(t)}},{key:"applyToAll",value:function(t){var s=this;this.applyReference(this.domainsWithReferences.definition.domain,t),this.domainKeys.map(function(c){var f;return null===(f=s.domainsWithReferences[c])||void 0===f?void 0:f.domains}).forEach(function(c){c&&c.forEach(function(f){s.applyReference(f,t)})}),this.substanceFormReferencesService.emitReferencesUpdate()}},{key:"applyReference",value:function(t,s){t.references||(t.references=[]),-1===t.references.indexOf(s)&&t.references.push(s)}}])}(z.u);return o.\u0275fac=function(r){return new(r||o)(e.Y36(F.B),e.Y36(x.v),e.Y36(V.w),e.Y36(w.W),e.Y36(B.p),e.Y36(O.uw),e.Y36(X.i),e.Y36(j.$),e.Y36(Z.Xj))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-substance-form-references-card"]],features:[e.qOj],decls:6,vars:4,consts:[[1,"flex-row"],["class","search",3,"floatLabel",4,"ngIf"],[1,"middle-fill"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page",4,"ngIf"],["class","reference","appScrollToTarget","",3,"id",4,"ngFor","ngForOf"],[1,"search",3,"floatLabel"],["matInput","","placeholder","Search",3,"formControl"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page"],["appScrollToTarget","",1,"reference",3,"id"],[3,"reference","referenceDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[1,"form-divider",3,"inset"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0),e.YNc(1,re,2,2,"mat-form-field",1),e._UZ(2,"span",2),e.qZA(),e.YNc(3,ie,1,5,"mat-paginator",3),e.YNc(4,se,3,3,"div",4),e.YNc(5,ae,1,5,"mat-paginator",3)),2&r&&(e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>n.pageSize),e.xp6(2),e.Q6J("ngIf",n.references&&n.references.length>5),e.xp6(1),e.Q6J("ngForOf",n.paged),e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>5))},directives:[m.O5,C.KE,S.Nt,d.Fj,d.JJ,d.oH,A.NW,m.sg,k.P,ne,D.d],styles:[".mat-divider.mat-divider-inset[_ngcontent-%COMP%]{margin-left:0}.mat-divider[_ngcontent-%COMP%]{border-top-color:var(--text-color)}.reference[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--nth-child-color-2)}.reference[_ngcontent-%COMP%]:nth-child(odd)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.reference[_ngcontent-%COMP%]:nth-child(even)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.search[_ngcontent-%COMP%]{width:400px;max-width:100%}"]}),o}(),le=i(75143),fe=i(7168),de=i(94673),pe=(i(64061),function(){var o=(0,g.Z)(function a(){(0,h.Z)(this,a)});return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[m.ez,le.o0.forChild(ce),D.t,de.w,I.Ps,M.ot,C.lN,d.UX,d.u5,A.TU,S.c,fe.O,P.AV]]}),o}())}}]);
//# sourceMappingURL=3298.3450d524ff6c1054.js.map