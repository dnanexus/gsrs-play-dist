"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[468],{20468:function(ge,_,a){a.r(_),a.d(_,{SubstanceFormReferencesModule:function(){return me}});var p=a(48047),m=a(78069),u=a(36362),S=a(80206),M=a(98568),Z=a(20265),A=a(24582),J=a(79550),U=a(91770),I=a(24874),T=a(24936),e=a(76442),x=a(95758),O=a(78444),F=a(54244),g=a(44770),v=a(43365),d=a(90587),b=a(26439),D=a(51279),N=a(42827),P=a(92507),Q=a(52149),w=a(33567),Y=a(99154),h=a(87317),C=a(65590),E=a(16667),k=a(84577),H=a(15992),q=a(53349),z=a(14900);function j(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div",12),e._uU(1," Deleted\xa0 "),e.TgZ(2,"button",13),e.NdJ("click",function(){return e.CHM(r),e.oxw().undoDelete()}),e._UZ(3,"mat-icon",14),e.qZA(),e.qZA()}}function L(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",22),e.NdJ("click",function(){return e.CHM(r),e.oxw(2).deleteReference()}),e.TgZ(2,"span"),e._uU(3,"Delete"),e.qZA(),e._uU(4,"\xa0 "),e._UZ(5,"mat-icon",23),e.qZA(),e.qZA()}}function $(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",24),e.NdJ("selectedFile",function(o){return e.CHM(r),e.oxw(2).fileSelected(o)}),e.TgZ(2,"span"),e._uU(3,"Upload Document"),e.qZA(),e._uU(4,"\xa0 "),e._UZ(5,"mat-icon",25),e.qZA(),e.qZA()}}function V(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",26),e._uU(2," Attachment "),e._UZ(3,"mat-icon",27),e.qZA(),e.TgZ(4,"mat-menu",null,28),e.TgZ(6,"a",29),e.NdJ("click",function(){e.CHM(r);var i=e.oxw(2);return i.downloadDocument(i.reference.uploadedFile)}),e._uU(7,"Download"),e.qZA(),e.TgZ(8,"button",30),e.NdJ("selectedFile",function(i){return e.CHM(r),e.oxw(2).fileSelected(i)}),e._uU(9,"Replace"),e.qZA(),e.TgZ(10,"button",29),e.NdJ("click",function(){return e.CHM(r),e.oxw(2).reference.uploadedFile=null}),e._uU(11,"Delete"),e.qZA(),e.qZA(),e.qZA()}if(2&t){var n=e.MAs(5);e.xp6(1),e.Q6J("matMenuTriggerFor",n)}}function X(t,c){if(1&t&&(e.TgZ(0,"div",31),e.TgZ(1,"div",32),e._UZ(2,"mat-progress-spinner",33),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Uploading"),e.qZA(),e.qZA()),2&t){var r=e.oxw(2);e.xp6(2),e.Q6J("color",r.primary)}}function B(t,c){1&t&&(e.TgZ(0,"div",31),e._uU(1," Error: There was a problem uploading this document "),e.qZA())}function W(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",34),e.NdJ("click",function(){e.CHM(r);var i=e.oxw(2);return i.showPrev=!i.showPrev}),e.TgZ(2,"span"),e._uU(3),e.qZA(),e._uU(4,"\xa0 "),e.qZA(),e.qZA()}if(2&t){var n=e.oxw(2);e.xp6(3),e.hij("",n.showPrev?"Hide":"Use"," Previous Substance Reference")}}function K(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",34),e.NdJ("click",function(){return e.CHM(r),e.oxw(2).openPreviousDialog()}),e.TgZ(2,"span"),e._uU(3),e.qZA(),e._uU(4,"\xa0 "),e.qZA(),e.qZA()}if(2&t){var n=e.oxw(2);e.xp6(3),e.hij("",n.showPrev?"Hide":"Use"," Previous Substance Reference")}}function G(t,c){if(1&t&&(e.TgZ(0,"div"),e._UZ(1,"app-apply-reference",35),e.qZA()),2&t){var r=e.oxw(2);e.xp6(1),e.Q6J("subReferenceUuid",r.reference.uuid)}}function ee(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",2),e.TgZ(2,"mat-form-field",15),e.TgZ(3,"input",16),e.NdJ("ngModelChange",function(i){return e.CHM(r),e.oxw().reference.url=i}),e.qZA(),e.qZA(),e.TgZ(4,"mat-form-field"),e.TgZ(5,"input",17),e.NdJ("ngModelChange",function(i){return e.CHM(r),e.oxw().reference.id=i}),e.qZA(),e.qZA(),e.TgZ(6,"app-tag-selector",18),e.NdJ("tagsUpdate",function(i){return e.CHM(r),e.oxw().updateTags(i)}),e.qZA(),e.qZA(),e.TgZ(7,"div",19),e.YNc(8,L,6,0,"div",9),e.YNc(9,$,6,0,"div",9),e.YNc(10,V,12,1,"div",9),e.YNc(11,X,5,1,"div",20),e.YNc(12,B,2,0,"div",20),e.YNc(13,W,5,1,"div",9),e.YNc(14,K,5,1,"div",9),e._UZ(15,"span",21),e.YNc(16,G,2,1,"div",9),e.qZA(),e.qZA()}if(2&t){var n=e.oxw();e.xp6(3),e.Q6J("ngModel",n.reference.url),e.xp6(2),e.Q6J("ngModel",n.reference.id),e.xp6(1),e.Q6J("tags",n.reference.tags),e.xp6(2),e.Q6J("ngIf",n.reference.uuid&&!n.hideDelete),e.xp6(1),e.Q6J("ngIf",!(n.disableReferenceDocumentUpload||n.reference.uploadedFile)),e.xp6(1),e.Q6J("ngIf",n.reference.uploadedFile),e.xp6(1),e.Q6J("ngIf",!0===n.loading),e.xp6(1),e.Q6J("ngIf",!1===n.loading&&!0===n.error),e.xp6(1),e.Q6J("ngIf",!n.reference.uuid),e.xp6(1),e.Q6J("ngIf",n.reference.uuid&&!n.reference.docType&&!n.reference.citation),e.xp6(2),e.Q6J("ngIf",n.reference.uuid)}}function ne(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"app-previous-references",36),e.NdJ("selectedReference",function(o){return e.CHM(r),e.oxw().fillReference(o)}),e.qZA(),e.qZA()}}var te=function(){var t=function(){function c(r,n,o,i,s,f,l){(0,m.Z)(this,c),this.cvService=r,this.configService=n,this.utilsService=o,this.substanceFormReferencesService=i,this.dialog=s,this.overlayContainerService=f,this.substanceFormService=l,this.referenceDeleted=new e.vpe,this.hideDelete=!1,this.disableReferenceDocumentUpload=!1,this.showPrev=!1,this.loading=!1,this.error=!1,this.subscriptions=[]}return(0,p.Z)(c,[{key:"ngOnInit",value:function(){this.overlayContainer=this.overlayContainerService.getContainerElement(),this.disableReferenceDocumentUpload=this.configService.configData.disableReferenceDocumentUpload}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(n){n.unsubscribe()})}},{key:"updateAccess",value:function(n){this.reference.access=n}},{key:"updateTags",value:function(n){this.reference.tags=n}},{key:"isValid",get:function(){return!(!this.reference.docType||!this.reference.citation)}},{key:"deleteReference",value:function(){var n=this;this.reference.$$deletedCode=this.utilsService.newUUID(),this.reference.docType||this.reference.citation||this.reference.uploadedFile?this.substanceFormReferencesService.emitReferencesUpdate():this.deleteTimer=setTimeout(function(){n.referenceDeleted.emit(n.reference)},2e3)}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.reference.$$deletedCode,this.substanceFormReferencesService.emitReferencesUpdate()}},{key:"fileSelected",value:function(n){var o=this;this.error=!1,null!=n&&(this.loading=!0,this.utilsService.uploadFile(n).subscribe(function(i){o.reference.uploadedFile=i,o.loading=!1},function(i){o.loading=!1,o.error=!0}))}},{key:"openPreviousDialog",value:function(){var n=this,o=this.dialog.open(Y.U,{data:{},width:"990px"});this.overlayContainer.style.zIndex="1002";var i=o.afterClosed().subscribe(function(s){n.overlayContainer.style.zIndex=null,s&&s.citation&&""!==s.citation&&s.docType&&""!==s.docType&&n.fillReference(s)});this.subscriptions.push(i)}},{key:"fillReference",value:function(n){this.showPrev=!1,this.reference.access=n.access,this.reference.citation=n.citation,this.reference.deprecated=n.deprecated,this.reference.docType=n.docType,this.reference.publicDomain=n.publicDomain,this.reference.tags=n.tags,this.reference.uploadedFile=n.uploadedFile,this.reference.url=n.url||null,this.reference.id=n.id||null}},{key:"downloadDocument",value:function(n){this.substanceFormService.bypassUpdateCheck(),window.open(n)}}]),c}();return t.\u0275fac=function(r){return new(r||t)(e.Y36(N.I),e.Y36(P.E),e.Y36(Q.F),e.Y36(T.v),e.Y36(x.uw),e.Y36(F.Xj),e.Y36(w.B))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-reference-form"]],inputs:{reference:"reference",hideDelete:"hideDelete"},outputs:{referenceDeleted:"referenceDeleted"},decls:15,vars:8,consts:[[1,"reference-form-container"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],["required","true","domain","DOCUMENT_TYPE","title","Source Type","name","docType",1,"source-type",3,"model","valueChange"],[1,"citation"],["matInput","","placeholder","Source Text/Citation","required","","name","citation",3,"ngModel","ngModelChange"],[1,"checkbox-container"],["name","publicDomain",3,"ngModel","ngModelChange"],[3,"access","accessOut"],[4,"ngIf"],["class","form-row ",4,"ngIf"],[3,"source"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"url"],["matInput","","placeholder","URL","name","refUrl",3,"ngModel","ngModelChange"],["matInput","","placeholder","Source Id","name","refId",3,"ngModel","ngModelChange"],["cvDomain","DOCUMENT_COLLECTION",1,"tags",3,"tags","tagsUpdate"],[1,"form-row","form-actions"],["class","loading-container",4,"ngIf"],[1,"middle-fill"],["mat-button","",3,"click"],["svgIcon","delete_forever"],["mat-button","","ncatsFileSelect","",3,"selectedFile"],["svgIcon","cloud_upload"],["mat-button","",3,"matMenuTriggerFor"],["svgIcon","attachment"],["documentMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","","ncatsFileSelect","",3,"selectedFile"],[1,"loading-container"],[1,"spinner-container"],["mode","indeterminate",1,"progress-spinner","spinner",3,"color"],["mat-button","","matTooltip","use a previously submitted reference",3,"click"],[3,"subReferenceUuid"],[1,"previous-ref",3,"selectedReference"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0),e.YNc(1,j,4,0,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"app-cv-input",3),e.NdJ("valueChange",function(i){return n.reference.docType=i}),e.qZA(),e.TgZ(4,"mat-form-field",4),e.TgZ(5,"input",5),e.NdJ("ngModelChange",function(i){return n.reference.citation=i}),e.qZA(),e.qZA(),e.TgZ(6,"div",6),e.TgZ(7,"mat-checkbox",7),e.NdJ("ngModelChange",function(i){return n.reference.publicDomain=i}),e._uU(8," Public Domain "),e.qZA(),e.qZA(),e.TgZ(9,"div"),e.TgZ(10,"app-access-manager",8),e.NdJ("accessOut",function(i){return n.updateAccess(i)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(11,ee,17,11,"div",9),e.YNc(12,ne,2,0,"div",10),e.TgZ(13,"div",2),e._UZ(14,"app-audit-info",11),e.qZA(),e.qZA()),2&r&&(e.xp6(1),e.Q6J("ngIf",n.reference.$$deletedCode),e.xp6(2),e.Q6J("model",n.reference.docType),e.xp6(2),e.Q6J("ngModel",n.reference.citation),e.xp6(2),e.Q6J("ngModel",n.reference.publicDomain),e.xp6(3),e.Q6J("access",n.reference.access),e.xp6(1),e.Q6J("ngIf",!n.reference.$$deletedCode),e.xp6(1),e.Q6J("ngIf",n.showPrev),e.xp6(2),e.Q6J("source",n.reference))},directives:[u.O5,h.lW,C.Hw,E.S,g.KE,v.Nt,d.Fj,d.Q7,d.JJ,d.On,k.h,H.C,q.s,z.n],styles:[".reference-form-container[_ngcontent-%COMP%]{padding:30px 0 12px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0 10px;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{padding-bottom:18px}.form-actions[_ngcontent-%COMP%]{-ms-flex-pack:start;justify-content:flex-start;margin:5px 0 10px}.source-type[_ngcontent-%COMP%], .citation[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]{width:30%}.tags[_ngcontent-%COMP%]{width:40%}.previous-ref[_ngcontent-%COMP%]{margin:auto;width:90%}.spinner[_ngcontent-%COMP%]{height:20px;width:20px}.loading-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;text-align:center;height:26px}.spinner-container[_ngcontent-%COMP%]{height:20px;width:20px;margin-right:5px}.progress-spinner[_ngcontent-%COMP%]{margin:auto}.mat-progress-spinner[_ngcontent-%COMP%]{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]     svg{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:20px!important;width:20px!important}"]}),t}(),R=a(19975);function oe(t,c){if(1&t&&(e.TgZ(0,"mat-form-field",6),e._UZ(1,"input",7),e.qZA()),2&t){var r=e.oxw();e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",r.searchControl)}}var y=function(){return[5,10,25,100]};function ie(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"mat-paginator",8),e.NdJ("page",function(i){e.CHM(r);var s=e.oxw();return s.pageChange(i,s.analyticsEventCategory)}),e.qZA()}if(2&t){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,y))}}function ae(t,c){1&t&&e._UZ(0,"mat-divider",12),2&t&&e.Q6J("inset",!0)}function ce(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"app-reference-form",10),e.NdJ("referenceDeleted",function(s){return e.CHM(r),e.oxw().deleteReference(s)}),e.qZA(),e.YNc(2,ae,1,1,"mat-divider",11),e.qZA()}if(2&t){var n=c.$implicit,o=c.last;e.Q6J("id",n.uuid),e.xp6(1),e.Q6J("reference",n),e.xp6(1),e.Q6J("ngIf",!o)}}function se(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"mat-paginator",8),e.NdJ("page",function(i){e.CHM(r);var s=e.oxw();return s.pageChange(i,s.analyticsEventCategory)}),e.qZA()}if(2&t){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,y))}}function le(t,c){if(1&t){var r=e.EpF();e.TgZ(0,"div",13),e._UZ(1,"span",2),e.TgZ(2,"button",14),e.NdJ("click",function(){return e.CHM(r),e.oxw().addSubstanceReference()}),e._uU(3," Add reference "),e._UZ(4,"mat-icon",15),e.qZA(),e.qZA()}}var de=function(){var t=function(c){function r(n,o,i,s,f){var l;return(0,m.Z)(this,r),l=function re(t,c,r){return c=(0,Z.Z)(c),(0,S.Z)(t,(0,M.Z)()?Reflect.construct(c,r||[],(0,Z.Z)(t).constructor):c.apply(t,r))}(this,r,[s]),l.substanceFormReferencesService=n,l.dialog=o,l.scrollToService=i,l.gaService=s,l.overlayContainerService=f,l.subscriptions=[],l.analyticsEventCategory="substance form references",l}return(0,A.Z)(r,c),(0,p.Z)(r,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("References"),this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var o=this,i=this.substanceFormReferencesService.substanceReferences.subscribe(function(s){o.references=s,o.filtered=s;var f=o.searchControl.valueChanges.subscribe(function(l){o.filterList(l,o.references,o.analyticsEventCategory)},function(l){console.log(l)});o.subscriptions.push(f),o.page=0,o.pageChange()});this.subscriptions.push(i)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(o){o.unsubscribe()})}},{key:"openReferenceFormDialog",value:function(){var o=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{access:[]},s=this.dialog.open(U.n,{data:i,width:"900px"});this.overlayContainer.style.zIndex="1002";var f=s.afterClosed().subscribe(function(l){o.overlayContainer.style.zIndex=null,null!=l&&l.doctype&&l.citation&&o.substanceFormReferencesService.addSubstanceReference(l)});this.subscriptions.push(f)}},{key:"addItem",value:function(){this.addSubstanceReference()}},{key:"addSubstanceReference",value:function(){var o=this,i=this.substanceFormReferencesService.addSubstanceReference({});setTimeout(function(){o.scrollToService.scrollToElement(i.uuid,"center")},10)}},{key:"deleteReference",value:function(o){this.substanceFormReferencesService.deleteSubstanceReference(o)}}]),r}(J.u);return t.\u0275fac=function(r){return new(r||t)(e.Y36(T.v),e.Y36(x.uw),e.Y36(O.i),e.Y36(I.$),e.Y36(F.Xj))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-substance-form-references-card"]],features:[e.qOj],decls:7,vars:5,consts:[[1,"flex-row"],["class","search",3,"floatLabel",4,"ngIf"],[1,"middle-fill"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page",4,"ngIf"],["class","reference","appScrollToTarget","",3,"id",4,"ngFor","ngForOf"],["style","display: flex;",4,"ngIf"],[1,"search",3,"floatLabel"],["matInput","","placeholder","Search",3,"formControl"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page"],["appScrollToTarget","",1,"reference",3,"id"],[3,"reference","referenceDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[1,"form-divider",3,"inset"],[2,"display","flex"],["mat-button","",3,"click"],["svgIcon","add_circle_outline"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0),e.YNc(1,oe,2,2,"mat-form-field",1),e._UZ(2,"span",2),e.qZA(),e.YNc(3,ie,1,5,"mat-paginator",3),e.YNc(4,ce,3,3,"div",4),e.YNc(5,se,1,5,"mat-paginator",3),e.YNc(6,le,5,0,"div",5)),2&r&&(e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>n.pageSize),e.xp6(2),e.Q6J("ngIf",n.references&&n.references.length>5),e.xp6(1),e.Q6J("ngForOf",n.paged),e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>5),e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>0))},directives:[u.O5,g.KE,v.Nt,d.Fj,d.JJ,d.oH,b.NW,u.sg,D.P,te,R.d,h.lW,C.Hw],styles:[".mat-divider.mat-divider-inset[_ngcontent-%COMP%]{margin-left:0}.mat-divider[_ngcontent-%COMP%]{border-top-color:var(--text-color)}.reference[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--nth-child-color-2)}.reference[_ngcontent-%COMP%]:nth-child(odd)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.reference[_ngcontent-%COMP%]:nth-child(even)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.search[_ngcontent-%COMP%]{width:400px;max-width:100%}"]}),t}(),fe=a(75143),ue=a(7168),pe=a(94673),me=(a(64061),function(){var t=(0,p.Z)(function c(){(0,m.Z)(this,c)});return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[u.ez,fe.o0.forChild(de),ue.O,R.t,pe.w,C.Ps,h.ot,g.lN,d.UX,d.u5,b.TU,v.c]]}),t}())}}]);
//# sourceMappingURL=468.a81b0622840292f1.js.map