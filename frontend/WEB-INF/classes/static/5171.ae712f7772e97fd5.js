"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[5171],{35171:function(se,C,o){o.r(C),o.d(C,{SubstanceFormDisulfideLinksModule:function(){return ne}});var v=o(48047),g=o(78069),f=o(36362),A=o(75143),M=o(7168),x=o(19975),h=o(65590),k=o(87317),P=o(94673),b=o(44770),c=o(90587),U=o(26439),J=o(43365),y=o(40089),N=o(31959),Y=o(10853),w=o(98568),L=o(20265),Q=o(24582),E=o(79550),D=o(35354),V=o(40104),F=o(39401),Z=o(33567),e=o(76442),S=o(95758),T=o(54244),$=o(51279),j=o(63169),z=o(18291),I=o(91434),B=o(1130);function H(s,a){if(1&s){var n=e.EpF();e.TgZ(0,"div",9),e._uU(1," Deleted\xa0 "),e.TgZ(2,"button",10),e.NdJ("click",function(){return e.CHM(n),e.oxw().undoDelete()}),e._UZ(3,"mat-icon",11),e.qZA(),e.qZA()}}function X(s,a){if(1&s&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&s){var n=a.$implicit;e.Q6J("value",n),e.xp6(1),e.AsE(" ",n.subunitIndex,"_",n.residueIndex," ")}}function R(s,a){if(1&s){var n=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"mat-form-field",13),e.TgZ(2,"mat-label"),e._uU(3),e.qZA(),e.TgZ(4,"mat-select",14),e.NdJ("selectionChange",function(r){var m=e.CHM(n).index;return e.oxw().updateSuggestions(r.value,m)}),e.YNc(5,X,2,3,"mat-option",15),e.TgZ(6,"mat-option",16),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&s){var i=a.$implicit,t=a.index,l=e.oxw();e.xp6(3),e.Oqu(0===t?"To":"From"),e.xp6(1),e.Q6J("formControlName","site"+t),e.xp6(1),e.Q6J("ngForOf",l.cysteine),e.xp6(1),e.Q6J("value",i),e.xp6(1),e.AsE(" ",i.subunitIndex,"_",i.residueIndex," ")}}var _=function(){var s=function(){return(0,v.Z)(function a(n,i,t,l,d,r){(0,g.Z)(this,a),this.cvService=n,this.dialog=i,this.utilsService=t,this.overlayContainerService=l,this.substanceFormService=d,this.substanceFormDisulfideLinksService=r,this.cysteine=[],this.linkDeleted=new e.vpe,this.testForm=new c.cw({site0:new c.NI("",[c.kI.required]),site1:new c.NI("",[c.kI.required])}),this.subscriptions=[]},[{key:"ngOnInit",value:function(){this.privateLink.sites?(this.testForm.controls.site0.setValue(this.privateLink.sites[0]),this.testForm.controls.site1.setValue(this.privateLink.sites[1])):this.privateLink.sites=[{},{}],this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var i=this;setTimeout(function(){var t=i.substanceFormDisulfideLinksService.substanceCysteineSites.subscribe(function(l){i.cysteine=l});i.subscriptions.push(t)})}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(i){i.unsubscribe()})}},{key:"link",get:function(){return this.privateLink},set:function(i){this.privateLink=i}},{key:"deleteLink",value:function(){var i=this;confirm("Are you sure you want to delete links?")&&(this.privateLink.$$deletedCode=this.utilsService.newUUID(),this.deleteTimer=setTimeout(function(){i.linkDeleted.emit(i.link)},1e3),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate())}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.privateLink.$$deletedCode,this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"updateAccess",value:function(i){this.link.access=i}},{key:"updateSuggestions",value:function(i,t){this.cysteine=this.cysteine.filter(function(l){return l.residueIndex!==i.residueIndex||l.subunitIndex!==i.subunitIndex}),this.privateLink.sites[t]!==i&&(this.privateLink.sites[t].residueIndex&&this.cysteine.push(this.privateLink.sites[t]),this.privateLink.sites[t]=i,this.substanceFormDisulfideLinksService.updateCysteine(this.cysteine)),this.testForm.controls["site"+t].setValue(i)}},{key:"openDialog",value:function(){var i=this,t=this.privateLink.sites;(!t[0].residueIndex||!t[1].residueIndex)&&(t=[]);var l=this.dialog.open(F.r,{data:{card:"disulfide",link:t},width:"1040px",panelClass:"subunit-dialog"});this.overlayContainer.style.zIndex="1002";var d=l.afterClosed().subscribe(function(r){i.overlayContainer.style.zIndex=null,r&&(r[0]&&r[0].subunitIndex?(i.privateLink.sites[0]=r[0],i.testForm.controls.site0.setValue(i.privateLink.sites[0])):(i.privateLink.sites[0]={},i.testForm.controls.site0.reset()),r[1]&&r[1].subunitIndex?(i.privateLink.sites[1]=r[1],i.testForm.controls.site1.setValue(i.privateLink.sites[1])):(i.privateLink.sites[1]={},i.testForm.controls.site1.reset())),i.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()});this.subscriptions.push(d)}}])}();return s.\u0275fac=function(n){return new(n||s)(e.Y36(z.I),e.Y36(S.uw),e.Y36(j.FW),e.Y36(T.Xj),e.Y36(Z.B),e.Y36(D.n))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-disulfide-links-form"]],inputs:{link:"link"},outputs:{linkDeleted:"linkDeleted"},decls:9,vars:3,consts:[[1,"link-form-container",3,"formGroup"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete link",3,"click"],["svgIcon","delete_forever"],["class","sites",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Select from sequence view",3,"click"],["svgIcon","edit"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"sites"],[1,"site"],[1,"site-select",3,"formControlName","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.YNc(1,H,4,0,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){return i.deleteLink()}),e._UZ(5,"mat-icon",5),e.qZA(),e.qZA(),e.YNc(6,R,8,6,"div",6),e.TgZ(7,"button",7),e.NdJ("click",function(){return i.openDialog()}),e._UZ(8,"mat-icon",8),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Q6J("formGroup",i.testForm),e.xp6(1),e.Q6J("ngIf",i.link.$$deletedCode),e.xp6(5),e.Q6J("ngForOf",i.link.sites))},directives:[c.JL,c.sg,f.O5,k.lW,y.gM,h.Hw,f.sg,b.KE,b.hX,I.gD,c.JJ,c.u,B.ey],styles:[".notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.link-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .site[_ngcontent-%COMP%]{max-width:80px}.form-row[_ngcontent-%COMP%]   sites[_ngcontent-%COMP%]{width:35%}"]}),s}(),W=o(14900);function K(s,a){1&s&&e._UZ(0,"mat-divider",15),2&s&&e.Q6J("vertical",!0)("inset",!0)}function q(s,a){1&s&&e._UZ(0,"mat-divider",16),2&s&&e.Q6J("inset",!0)}function ee(s,a){if(1&s){var n=e.EpF();e.TgZ(0,"div",11),e.YNc(1,K,1,2,"mat-divider",12),e.TgZ(2,"app-disulfide-links-form",13),e.NdJ("linkDeleted",function(u){return e.CHM(n),e.oxw().deleteDisulfideLink(u)}),e.qZA(),e.YNc(3,q,1,1,"mat-divider",14),e.qZA()}if(2&s){var i=a.$implicit,t=a.last,l=a.index,d=e.oxw();e.Q6J("id","substance-disulfide-links-"+l)("ngClass",l%2==0?"side-border":""),e.xp6(1),e.Q6J("ngIf",l%2==0),e.xp6(1),e.Q6J("link",i),e.xp6(1),e.Q6J("ngIf",!t&&l!==d.disulfideLinks.length-2)}}function ie(s,a){if(1&s){var n=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw().deleteAllDisulfideLinks()}),e._uU(2," Delete All Links\n"),e.qZA(),e.qZA()}}var te=function(){var s=function(a){function n(i,t,l,d,r){var u;return(0,g.Z)(this,n),u=function G(s,a,n){return a=(0,L.Z)(a),(0,Y.Z)(s,(0,w.Z)()?Reflect.construct(a,n||[],(0,L.Z)(s).constructor):a.apply(s,n))}(this,n,[l]),u.substanceFormDisulfideLinksService=i,u.substanceFormService=t,u.gaService=l,u.dialog=d,u.overlayContainerService=r,u.subscriptions=[],u.analyticsEventCategory="substance form disulfide Links",u}return(0,Q.Z)(n,a),(0,v.Z)(n,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("Disulfide Links"),this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var t=this,l=this.substanceFormDisulfideLinksService.substanceDisulfideLinks.subscribe(function(u){t.disulfideLinks=u,t.countCysteine()});this.subscriptions.push(l);var d=this.substanceFormService.substanceSubunits.subscribe(function(u){t.subunits=u,t.countCysteine()});this.subscriptions.push(d);var r=this.substanceFormDisulfideLinksService.substanceCysteineSites.subscribe(function(u){t.cysteine=u,t.countCysteine()});this.subscriptions.push(r)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(t){t.unsubscribe()})}},{key:"countCysteine",value:function(){var t=this;null!=this.disulfideLinks&&null!=this.subunits&&null!=this.cysteine&&(this.cysteineBonds=0,this.subunits&&this.subunits.forEach(function(l){t.cysteineBonds+=l.sequence.toUpperCase().split("C").length-1}),this.cysteine&&this.cysteine.length?this.cysteineBonds=this.cysteine.length:this.cysteineBonds-=2*this.disulfideLinks.length,this.getSuggestions())}},{key:"getSuggestions",value:function(){var t=[];if(this.subunits)for(var l=0;l<this.subunits.length;l++){var d=this.subunits[l].sequence;if(null!=d&&d.length>0)for(var r=0;r<d.length;r++)"C"===d[r].toUpperCase()&&t.push({residueIndex:r+1,subunitIndex:l+1})}this.disulfideLinks.forEach(function(m){m.sites&&m.sites.forEach(function(p){t=t.filter(function(O){return O.residueIndex!==p.residueIndex||O.subunitIndex!==p.subunitIndex})})})}},{key:"addItem",value:function(){this.addLink()}},{key:"addLink",value:function(){this.substanceFormDisulfideLinksService.addSubstanceDisulfideLink(),setTimeout(function(){}),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"deleteDisulfideLink",value:function(t){this.substanceFormDisulfideLinksService.deleteSubstanceDisulfideLink(t),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate()}},{key:"deleteAllDisulfideLinks",value:function(){confirm("Are you sure you want to delete all links?")&&(this.substanceFormDisulfideLinksService.deleteAllDisulfideLinks(),this.substanceFormDisulfideLinksService.emitDisulfideLinkUpdate())}},{key:"openDialog",value:function(){var t=this,l=this.dialog.open(F.r,{data:{card:"multi-disulfide",link:[]},width:"1040px",panelClass:"subunit-dialog"});this.overlayContainer.style.zIndex="1002";var d=l.afterClosed().subscribe(function(r){t.overlayContainer.style.zIndex=null,r&&t.substanceFormDisulfideLinksService.addCompleteDisulfideLinks(r)});this.subscriptions.push(d)}}])}(E.u);return s.\u0275fac=function(n){return new(n||s)(e.Y36(D.n),e.Y36(Z.B),e.Y36(V.$),e.Y36(S.uw),e.Y36(T.Xj))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-substance-form-disulfide-links-card"]],features:[e.qOj],decls:16,vars:4,consts:[[1,"responsive","columns"],[1,"flex-row","form-row2"],[1,"add-buttons"],["mat-button","",3,"click"],["svgIcon","add_circle_outline"],[1,"cysteine"],["appScrollToTarget","","class","site-set alternate-backgrounds2",3,"id","ngClass",4,"ngFor","ngForOf"],["class","flex-row",4,"ngIf"],[3,"source"],[1,"flex-row"],[1,"middle-fill"],["appScrollToTarget","",1,"site-set","alternate-backgrounds2",3,"id","ngClass"],["style","",3,"vertical","inset",4,"ngIf"],[3,"link","linkDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[3,"vertical","inset"],[1,"form-divider",3,"inset"],["mat-raised-button","","mat-primary","",3,"click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return i.openDialog()}),e._uU(4," Add Multiple Links "),e._UZ(5,"mat-icon",4),e.qZA(),e.qZA(),e.TgZ(6,"div",5),e._uU(7),e.qZA(),e.qZA(),e.YNc(8,ee,4,5,"div",6),e.qZA(),e.YNc(9,ie,3,0,"div",7),e._UZ(10,"app-audit-info",8),e.TgZ(11,"div",9),e._UZ(12,"span",10),e.TgZ(13,"button",3),e.NdJ("click",function(){return i.addLink()}),e._uU(14," Add Disulfide Link "),e._UZ(15,"mat-icon",4),e.qZA(),e.qZA()),2&n&&(e.xp6(7),e.hij(" Number of unspecified Cysteine residues: ",i.cysteineBonds," "),e.xp6(1),e.Q6J("ngForOf",i.disulfideLinks),e.xp6(1),e.Q6J("ngIf",i.disulfideLinks&&i.disulfideLinks.length>0),e.xp6(1),e.Q6J("source",i.disulfideLinks))},directives:[k.lW,h.Hw,f.sg,$.P,f.mk,f.O5,x.d,_,W.n],styles:[".link-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row2[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end;-ms-flex:1 0 99%;flex:1 0 99%}.form-row2[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row2[_ngcontent-%COMP%]   .add-buttons[_ngcontent-%COMP%]{width:40%}.form-row2[_ngcontent-%COMP%]   .cysteine[_ngcontent-%COMP%]{width:50%}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end}.site-set[_ngcontent-%COMP%]{-ms-flex:1 0 48%;flex:1 0 48%;margin:5px;max-width:50%}.columns[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n){background-color:var(--nth-child-color-2)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+3){background-color:var(--nth-child-color-2)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+3)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+1)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.alternate-backgrounds2[_ngcontent-%COMP%]:nth-child(4n+2)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.alternate-backgrounds2[_ngcontent-%COMP%]     .mat-expansion-panel, .alternate-backgrounds2[_ngcontent-%COMP%]     .mat-table, .alternate-backgrounds2[_ngcontent-%COMP%]     textarea{background-color:var(--regular-transparent-color)}"]}),s}(),ne=(o(64061),function(){var s=(0,v.Z)(function a(){(0,g.Z)(this,a)});return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[f.ez,A.o0.forChild(te),M.O,x.t,h.Ps,k.ot,P.w,b.lN,c.UX,c.u5,U.TU,y.AV,N.vV,J.c,I.LD]]}),s}())}}]);
//# sourceMappingURL=5171.ae712f7772e97fd5.js.map