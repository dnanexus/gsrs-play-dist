"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[3298],{23298:function(re,C,o){o.r(C),o.d(C,{SubstanceFormSimplifiedReferencesModule:function(){return te}});var u=o(48047),m=o(78069),p=o(36362),P=o(10853),I=o(98568),y=o(20265),A=o(24582),D=o(79550),J=o(40104),S=o(24936),N=o(32685),E=o(59295),e=o(76442),x=o(95758),Q=o(78444),R=o(54244),g=o(44770),v=o(43365),d=o(90587),b=o(26439),U=o(51279),Y=o(63169),w=o(33567),z=o(99154),T=o(87317),F=o(40089),O=o(65590),k=o(16667),j=o(84577);function $(i,s){if(1&i){var t=e.EpF();e.TgZ(0,"div",8),e._uU(1," Deleted\xa0 "),e.TgZ(2,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().undoDelete()}),e._UZ(3,"mat-icon",10),e.qZA(),e.qZA()}}function H(i,s){if(1&i){var t=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw().deleteReference()}),e._UZ(2,"mat-icon",13),e.qZA(),e.qZA()}}var L=function(){var i=function(){return(0,u.Z)(function s(t,n,r,a,c){(0,m.Z)(this,s),this.utilsService=t,this.substanceFormReferencesService=n,this.dialog=r,this.overlayContainerService=a,this.substanceFormService=c,this.referenceDeleted=new e.vpe,this.hideDelete=!1,this.showPrev=!1,this.loading=!1,this.error=!1,this.subscriptions=[]},[{key:"ngOnInit",value:function(){this.overlayContainer=this.overlayContainerService.getContainerElement(),this.reference.publicDomain=!1,this.reference.access=["protected"]}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(n){n.unsubscribe()})}},{key:"updateAccess",value:function(n){this.reference.access=n}},{key:"setSourceType",value:function(n){n&&(this.reference.docType=n,this.reference.citation=n)}},{key:"updateTags",value:function(n){this.reference.tags=n}},{key:"isValid",get:function(){return!(!this.reference.docType||!this.reference.citation)}},{key:"deleteReference",value:function(){var n=this;this.reference.$$deletedCode=this.utilsService.newUUID(),this.reference.docType||this.reference.citation||this.reference.uploadedFile?this.substanceFormReferencesService.emitReferencesUpdate():this.deleteTimer=setTimeout(function(){n.referenceDeleted.emit(n.reference)},2e3)}},{key:"undoDelete",value:function(){clearTimeout(this.deleteTimer),delete this.reference.$$deletedCode,this.substanceFormReferencesService.emitReferencesUpdate()}},{key:"fileSelected",value:function(n){var r=this;this.error=!1,null!=n&&(this.loading=!0,this.utilsService.uploadFile(n).subscribe(function(a){r.reference.uploadedFile=a,r.loading=!1},function(a){r.loading=!1,r.error=!0}))}},{key:"openPreviousDialog",value:function(){var n=this,r=this.dialog.open(z.U,{data:{},width:"990px"});this.overlayContainer.style.zIndex="1002";var a=r.afterClosed().subscribe(function(c){n.overlayContainer.style.zIndex=null,c&&c.citation&&""!==c.citation&&c.docType&&""!==c.docType&&n.fillReference(c)});this.subscriptions.push(a)}},{key:"fillReference",value:function(n){this.showPrev=!1,this.reference.access=n.access,this.reference.citation=n.citation,this.reference.deprecated=n.deprecated,this.reference.docType=n.docType,this.reference.publicDomain=n.publicDomain,this.reference.tags=n.tags,this.reference.uploadedFile=n.uploadedFile,this.reference.url=n.url||null,this.reference.id=n.id||null}},{key:"downloadDocument",value:function(n){this.substanceFormService.bypassUpdateCheck(),window.open(n)}}])}();return i.\u0275fac=function(t){return new(t||i)(e.Y36(Y.FW),e.Y36(S.v),e.Y36(x.uw),e.Y36(R.Xj),e.Y36(w.B))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-reference-form"]],inputs:{reference:"reference",hideDelete:"hideDelete"},outputs:{referenceDeleted:"referenceDeleted"},decls:9,vars:5,consts:[[1,"reference-form-container"],["class","notification-backdrop",4,"ngIf"],[1,"form-row"],["class","delete-container",4,"ngIf"],["required","true","domain","DOCUMENT_TYPE","title","Source Type",1,"source-type",3,"model","valueChange"],[1,"citation"],["matInput","","placeholder","Source Text/Citation","required","","name","citation",3,"ngModel","ngModelChange"],[3,"access","accessOut"],[1,"notification-backdrop"],["mat-icon-button","","matTooltip","Undo",3,"click"],["svgIcon","undo"],[1,"delete-container"],["mat-icon-button","","matTooltip","Delete reference",3,"click"],["svgIcon","delete_forever"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,$,4,0,"div",1),e.TgZ(2,"div",2),e.YNc(3,H,3,0,"div",3),e.TgZ(4,"app-cv-input",4),e.NdJ("valueChange",function(a){return n.setSourceType(a)}),e.qZA(),e.TgZ(5,"mat-form-field",5),e.TgZ(6,"input",6),e.NdJ("ngModelChange",function(a){return n.reference.citation=a}),e.qZA(),e.qZA(),e.TgZ(7,"div"),e.TgZ(8,"app-access-manager",7),e.NdJ("accessOut",function(a){return n.updateAccess(a)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.reference.$$deletedCode),e.xp6(2),e.Q6J("ngIf",n.reference.uuid),e.xp6(1),e.Q6J("model",n.reference.docType),e.xp6(2),e.Q6J("ngModel",n.reference.citation),e.xp6(2),e.Q6J("access",n.reference.access))},directives:[p.O5,T.lW,F.gM,O.Hw,k.S,g.KE,v.Nt,d.Fj,d.Q7,d.JJ,d.On,j.h],styles:[".reference-form-container[_ngcontent-%COMP%]{padding:10px 3px 4px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;display:-ms-flexbox;display:flex;z-index:10;background-color:var(--notif-backdrop-bg-color);-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:var(--notif-backdrop-color)}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0 10px;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .source-type[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .citation[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-actions[_ngcontent-%COMP%]{-ms-flex-pack:start;justify-content:flex-start;margin:5px 0 10px}.url[_ngcontent-%COMP%]{width:30%}.tags[_ngcontent-%COMP%]{width:40%}.previous-ref[_ngcontent-%COMP%]{margin:auto;width:90%}.spinner[_ngcontent-%COMP%]{height:20px;width:20px}.loading-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;text-align:center;height:26px}.spinner-container[_ngcontent-%COMP%]{height:20px;width:20px;margin-right:5px}.progress-spinner[_ngcontent-%COMP%]{margin:auto}.mat-progress-spinner[_ngcontent-%COMP%]{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]     svg{height:20px!important;width:20px!important}.mat-progress-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:20px!important;width:20px!important}"]}),i}(),Z=o(19975);function V(i,s){if(1&i&&(e.TgZ(0,"mat-form-field",5),e._UZ(1,"input",6),e.qZA()),2&i){var t=e.oxw();e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",t.searchControl)}}var M=function(){return[5,10,25,100]};function X(i,s){if(1&i){var t=e.EpF();e.TgZ(0,"mat-paginator",7),e.NdJ("page",function(a){e.CHM(t);var c=e.oxw();return c.pageChange(a,c.analyticsEventCategory)}),e.qZA()}if(2&i){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,M))}}function B(i,s){1&i&&e._UZ(0,"mat-divider",11),2&i&&e.Q6J("inset",!0)}function K(i,s){if(1&i){var t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"app-reference-form",9),e.NdJ("referenceDeleted",function(c){return e.CHM(t),e.oxw().deleteReference(c)}),e.qZA(),e.YNc(2,B,1,1,"mat-divider",10),e.qZA()}if(2&i){var n=s.$implicit,r=s.last;e.Q6J("id",n.uuid),e.xp6(1),e.Q6J("reference",n),e.xp6(1),e.Q6J("ngIf",!r)}}function _(i,s){if(1&i){var t=e.EpF();e.TgZ(0,"mat-paginator",7),e.NdJ("page",function(a){e.CHM(t);var c=e.oxw();return c.pageChange(a,c.analyticsEventCategory)}),e.qZA()}if(2&i){var n=e.oxw();e.Q6J("length",n.filtered&&n.filtered.length||0)("pageIndex",n.page)("pageSize",5)("pageSizeOptions",e.DdM(4,M))}}var G=function(){var i=function(s){function t(n,r,a,c,l){var f;return(0,m.Z)(this,t),f=function W(i,s,t){return s=(0,y.Z)(s),(0,P.Z)(i,(0,I.Z)()?Reflect.construct(s,t||[],(0,y.Z)(i).constructor):s.apply(i,t))}(this,t,[c]),f.substanceFormReferencesService=n,f.dialog=r,f.scrollToService=a,f.gaService=c,f.overlayContainerService=l,f.domainKeys=N.Q,f.subscriptions=[],f.analyticsEventCategory="substance form references",f}return(0,A.Z)(t,s),(0,u.Z)(t,[{key:"ngOnInit",value:function(){this.canAddItemUpdate.emit(!0),this.menuLabelUpdate.emit("References"),this.overlayContainer=this.overlayContainerService.getContainerElement()}},{key:"ngAfterViewInit",value:function(){var r=this,a=this.substanceFormReferencesService.substanceReferences.subscribe(function(l){r.references=l,r.filtered=l;var f=r.searchControl.valueChanges.subscribe(function(h){r.filterList(h,r.references,r.analyticsEventCategory)},function(h){console.log(h)});r.subscriptions.push(f),r.page=0,r.pageChange()}),c=this.substanceFormReferencesService.domainsWithReferences.pipe((0,E.q)(1)).subscribe(function(l){r.domainsWithReferences=l});this.subscriptions.push(a),this.subscriptions.push(c)}},{key:"ngOnDestroy",value:function(){this.componentDestroyed.emit(),this.subscriptions.forEach(function(r){r.unsubscribe()})}},{key:"addItem",value:function(){this.addSubstanceReference()}},{key:"addSubstanceReference",value:function(){var r=this,a=this.substanceFormReferencesService.addSubstanceReference({});this.applyToAll(a.uuid),setTimeout(function(){r.scrollToService.scrollToElement(a.uuid,"center")},10)}},{key:"deleteReference",value:function(r){this.substanceFormReferencesService.deleteSubstanceReference(r)}},{key:"applyToAll",value:function(r){var a=this;this.applyReference(this.domainsWithReferences.definition.domain,r),this.domainKeys.map(function(c){var l;return null===(l=a.domainsWithReferences[c])||void 0===l?void 0:l.domains}).forEach(function(c){c&&c.forEach(function(l){a.applyReference(l,r)})}),this.substanceFormReferencesService.emitReferencesUpdate()}},{key:"applyReference",value:function(r,a){r.references||(r.references=[]),-1===r.references.indexOf(a)&&r.references.push(a)}}])}(D.u);return i.\u0275fac=function(t){return new(t||i)(e.Y36(S.v),e.Y36(x.uw),e.Y36(Q.i),e.Y36(J.$),e.Y36(R.Xj))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-substance-form-references-card"]],features:[e.qOj],decls:6,vars:4,consts:[[1,"flex-row"],["class","search",3,"floatLabel",4,"ngIf"],[1,"middle-fill"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page",4,"ngIf"],["class","reference","appScrollToTarget","",3,"id",4,"ngFor","ngForOf"],[1,"search",3,"floatLabel"],["matInput","","placeholder","Search",3,"formControl"],["showFirstLastButtons","true",3,"length","pageIndex","pageSize","pageSizeOptions","page"],["appScrollToTarget","",1,"reference",3,"id"],[3,"reference","referenceDeleted"],["class","form-divider",3,"inset",4,"ngIf"],[1,"form-divider",3,"inset"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,V,2,2,"mat-form-field",1),e._UZ(2,"span",2),e.qZA(),e.YNc(3,X,1,5,"mat-paginator",3),e.YNc(4,K,3,3,"div",4),e.YNc(5,_,1,5,"mat-paginator",3)),2&t&&(e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>n.pageSize),e.xp6(2),e.Q6J("ngIf",n.references&&n.references.length>5),e.xp6(1),e.Q6J("ngForOf",n.paged),e.xp6(1),e.Q6J("ngIf",n.references&&n.references.length>5))},directives:[p.O5,g.KE,v.Nt,d.Fj,d.JJ,d.oH,b.NW,p.sg,U.P,L,Z.d],styles:[".mat-divider.mat-divider-inset[_ngcontent-%COMP%]{margin-left:0}.mat-divider[_ngcontent-%COMP%]{border-top-color:var(--text-color)}.reference[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--nth-child-color-2)}.reference[_ngcontent-%COMP%]:nth-child(odd)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-3)}.reference[_ngcontent-%COMP%]:nth-child(even)     .mat-expansion-panel:not(.mat-expanded):not([aria-disabled=true]) .mat-expansion-panel-header:hover{background-color:var(--nth-child-color-1)}.search[_ngcontent-%COMP%]{width:400px;max-width:100%}"]}),i}(),q=o(75143),ee=o(7168),ne=o(94673),te=(o(64061),function(){var i=(0,u.Z)(function s(){(0,m.Z)(this,s)});return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[p.ez,q.o0.forChild(G),Z.t,ne.w,O.Ps,T.ot,g.lN,d.UX,d.u5,b.TU,v.c,ee.O,F.AV]]}),i}())}}]);
//# sourceMappingURL=3298.1792edaf5a4b269e.js.map